generator client {
  provider      = "prisma-client-js"
  binaryTargets = ["native", "linux-musl-openssl-3.0.x"]
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model Usuario {
  id              String          @id @default(uuid()) @db.Char(36)
  nome            String          @db.VarChar(100)
  email           String          @unique @db.VarChar(100)
  senha           String          @db.VarChar(60)
  avatarURL       String?         @db.VarChar(255)
  tipoUsuarioID   String          @db.Char(36)
  tipoUsuario     TipoUsuario     @relation(fields: [tipoUsuarioID], references: [id])
  createdAt       DateTime        @default(now()) @map("created_at")
  updatedAt       DateTime        @updatedAt @map("updated_at")
  campanha        Campanha[]
  endereco        Endereco[]
  formaPagamento  FormaPagamento[]
  contribuicao    Contribuicao[]
  postagem        Postagem[]
  mensagem        Mensagem[]
  itemRecompensa  ItemRecompensa[]

  @@map("usuarios")
}

model TipoUsuario {
  id       String     @id @default(uuid()) @db.Char(36)
  rotulo   String     @db.Char(8)
  usuario  Usuario[]

  @@map("tipos_usuarios")
}

model Endereco {
  id            String     @id @default(uuid()) @db.Char(36)
  numero        String     @db.VarChar(5)
  cep           String     @db.Char(8)
  cidade        String     @db.VarChar(100)
  uf            String     @db.Char(2)
  usuarioID     String     @db.Char(36)
  createdAt     DateTime   @default(now()) @map("created_at")
  updatedAt     DateTime   @updatedAt @map("updated_at")
  Usuario       Usuario    @relation(fields: [usuarioID], references: [id])

  @@map("enderecos")
}

model Campanha {
  id                String       @id @default(uuid()) @db.Char(36)
  meta              Decimal      @db.Decimal(10, 2)
  prazo             DateTime     @db.DateTime()
  titulo            String       @db.VarChar(50)
  descricao         String       @db.VarChar(200)
  categoria         String       @db.VarChar(50)
  logoURL           String?      @db.VarChar(255)
  usuarioID         String       @db.Char(36)
  createdAt         DateTime     @default(now()) @map("created_at")
  updatedAt         DateTime     @updatedAt @map("updated_at")
  usuario           Usuario      @relation(fields: [usuarioID], references: [id])
  contribuicao      Contribuicao[]
  recompensa        Recompensa[]
  postagem          Postagem[]
  mensagem          Mensagem[]

  @@map("campanhas")
}

model Contribuicao {
  id                 String          @id @default(uuid()) @db.Char(36)
  valor              Decimal         @db.Decimal(10, 2)
  usuarioID          String          @db.Char(36)
  campanhaID         String          @db.Char(36)
  formaID            String          @db.Char(36)
  createdAt          DateTime        @default(now()) @map("created_at")
  updatedAt          DateTime        @updatedAt @map("updated_at")
  usuario            Usuario         @relation(fields: [usuarioID], references: [id])
  campanha           Campanha        @relation(fields: [campanhaID], references: [id])
  formaPagamento     FormaPagamento  @relation(fields: [formaID], references: [id])
  @@map("contribuicoes")
}

model FormaPagamento {
  id                 String         @id @default(uuid()) @db.Char(36)
  tipo               String         @db.VarChar(10)
  usuarioID          String         @db.Char(36)
  createdAt          DateTime       @default(now()) @map("created_at")
  updatedAt          DateTime       @updatedAt @map("updated_at")
  usuario            Usuario        @relation(fields: [usuarioID], references: [id])
  contribuicao       Contribuicao[]

  @@map("formas_pagamento")
}

model Recompensa {
  id                 String         @id @default(uuid()) @db.Char(36)
  titulo             String         @db.VarChar(50)
  descricao          String         @db.VarChar(100)
  valorMinimo        Decimal        @db.Decimal(9, 2)
  imagemURL          String?        @db.VarChar(200)
  campanhaID         String         @db.Char(36)
  createdAt          DateTime       @default(now()) @map("created_at")
  updatedAt          DateTime       @updatedAt @map("updated_at")
  campanha           Campanha       @relation(fields: [campanhaID], references: [id])
  itemRecompensa     ItemRecompensa[]

  @@map("recompensas")
}

model ItemRecompensa {
  id                  String         @id @default(uuid()) @db.Char(36)
  recompensaID        String         @db.Char(36)
  usuarioID           String         @db.Char(36)
  createdAt           DateTime       @default(now()) @map("created_at")
  updatedAt           DateTime       @updatedAt @map("updated_at")
  recompensa          Recompensa     @relation(fields: [recompensaID], references: [id])
  usuario             Usuario        @relation(fields: [usuarioID], references: [id])

  @@map("itens_recompensa")
}

model Postagem {
  id                 String         @id @default(uuid()) @db.Char(36)
  titulo             String?        @db.VarChar(50)
  descricao          String?        @db.VarChar(200)
  usuarioID          String         @db.Char(36)
  campanhaID         String         @db.Char(36)
  createdAt          DateTime       @default(now()) @map("created_at")
  updatedAt          DateTime       @updatedAt @map("updated_at")
  usuario            Usuario        @relation(fields: [usuarioID], references: [id])
  campanha           Campanha       @relation(fields: [campanhaID], references: [id])

  @@map("postagens")
}

model Mensagem {
  id                 String         @id @default(uuid()) @db.Char(36)
  texto              String         @db.VarChar(200)
  usuarioID          String         @db.Char(36)
  campanhaID         String         @db.Char(36)
  createdAt          DateTime       @default(now()) @map("created_at")
  updatedAt          DateTime       @updatedAt @map("updated_at")
  usuario            Usuario        @relation(fields: [usuarioID], references: [id])
  campanha           Campanha       @relation(fields: [campanhaID], references: [id])

  @@map("mensagens")
}